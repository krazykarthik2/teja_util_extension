"use strict";(self.webpackChunkaest_util=self.webpackChunkaest_util||[]).push([[590],{6590:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var o=n(5043),s=n(3242),c=n(3537),l=n(6032),a=n(240),i=n(5661),r=n(579);function d(e){var t,n;let{hours:d,minutes:u,props:m,dispatch:h}=e;const[x,b]=(0,o.useState)([]),[v,p]=(0,o.useState)(""),[g,f]=(0,o.useState)(!1),[j,y]=(0,o.useState)(null),[N,k]=(0,o.useState)(!1);(0,o.useEffect)((()=>{N&&(console.log("Navigating to auto-results"),console.log(x),C("/auto/results",{state:x}))}),[N]);const C=(0,c.Zp)();(0,o.useEffect)((()=>{if(j)return;const e=new WebSocket("ws://localhost:4595");y(e),e.onopen=()=>{f(!0),b((e=>[...e,{by:"alert",content:"Connected to WebSocket"}]))},e.onmessage=e=>{b((t=>[...t,{by:"server",content:JSON.parse(e.data)}])),"batch-executed"===JSON.parse(e.data).action&&k(!0),console.log(e.data)},e.onerror=e=>{b((e=>[...e,{by:"server",content:"Error: Connection issue"}]))},e.onpong=()=>{b((e=>[...e,{by:"server",content:"Pong received"}]))},e.onclose=()=>{f(!1),b((e=>[...e,{by:"alert",content:"Disconnected from WebSocket"}])),y(null),alert("Disconnected from WebSocket"),console.log("Disconnected from WebSocket")}}),[j]),window.ws=j;const S=()=>{if(j)if(console.log(v.trim()),v.trim()){const t=(e=v.trim(),{command:{exec:i.Ay.load(e).map((e=>({name:e.name,command:Array.isArray(e.command)?e.command.join(" && "):e.command})))},action:"batch-commands"});console.log(t),j.send(JSON.stringify(t)),b((e=>[...e,{by:"you",content:"input"}])),p("")}else console.log("No input");else console.log("No connection");var e};return(0,r.jsxs)("div",{className:"p-4 w-full mx-auto bg-gray-900 text-white rounded-xl shadow-xl",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-3",children:"WebSocket API Terminal"}),(0,r.jsxs)("div",{className:"h-60 overflow-y-auto bg-black p-2 rounded-md mb-2",children:["FULL LOGS:",null===x||void 0===x?void 0:x.map(((e,t)=>(0,r.jsx)("div",{className:"text-green-400 text-sm",children:(0,r.jsx)(s.oz,{rehypePlugins:[l.A],children:JSON.stringify((null===e||void 0===e?void 0:e.content)||"")})},t)))]}),-1!=(null===x||void 0===x?void 0:x.findIndex((e=>"batch-created"===e.content.action)))&&(0,r.jsx)("div",{children:(0,r.jsx)(s.oz,{children:null===x||void 0===x||null===(t=x.find((e=>{var t;return"batch-created"===(null===e||void 0===e||null===(t=e.content)||void 0===t?void 0:t.action)})))||void 0===t||null===(n=t.content)||void 0===n?void 0:n.output})}),(0,r.jsxs)("div",{className:"flex w-full gap-2 mb-2 ",children:[(0,r.jsxs)("div",{className:"w-full batch-output",children:["BATCH OUTPUT:",null===x||void 0===x?void 0:x.filter((e=>"batch-output"===e.content.action)).map(((e,t)=>(0,r.jsx)("div",{className:"text-green-400 text-sm",children:(0,r.jsx)(s.oz,{rehypePlugins:[l.A],children:e.content.output})},t)))]}),(0,r.jsxs)("div",{className:"w-full batch-error text-red-400",children:["BATCH ERROR:",x.filter((e=>"batch-error"===e.content.action)).map(((e,t)=>(0,r.jsx)("div",{className:"text-red-400 text-sm",children:(0,r.jsx)(s.oz,{rehypePlugins:[l.A],children:JSON.stringify(e.content)})},t)))]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("textarea",{autoFocus:!0,className:"flex-1 bg-gray-800 border-none text-white",value:v,onChange:e=>p(e.target.value),placeholder:"Type command..."}),(0,r.jsx)("button",{onClick:()=>S(),disabled:!g,children:"Send"})]}),(0,r.jsxs)("p",{className:"mt-2 text-sm text-gray-400",children:["Status: ",g?"Connected":"Disconnected"]}),(0,r.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,r.jsx)("button",{onClick:()=>j.close(),disabled:!g,children:"Disconnect"}),(0,r.jsx)("button",{onClick:()=>{y(new WebSocket("ws://localhost:4595"))},disabled:g,children:"Connect"}),(0,r.jsx)("button",{onClick:()=>b([]),children:"Clear"}),(0,r.jsx)("button",{onClick:()=>j.terminate(),disabled:!g,children:"Terminate"}),(0,r.jsx)("button",{onClick:()=>j.close(),disabled:!g,children:"Close Connection"}),(0,r.jsx)("button",{onClick:()=>j.send("ping"),disabled:!g,children:"Ping"}),(0,r.jsx)("button",{onClick:()=>{j&&(j.send({command:{},action:"interrupt"}),b((e=>[...e,{by:"you",content:"Interrupt"}])))},children:"Interrupt"})]}),(0,r.jsx)(a.A,{hidden:!0,...m})]})}}}]);
//# sourceMappingURL=590.425658d8.chunk.js.map